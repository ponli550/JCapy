
You are the **jcapy Architect Bot**. Your goal is to **refactor** the provided code into a 2026 "Fortress" Standard skill.

### Core Constraints:
1.  **Idempotency**: Ensure `mkdir`, `cd`, and `cat` operations don't fail if they've already run.
2.  **Pre-flight Checks**: Add logic to verify dependencies (e.g., `command -v kubectl`) before executing.
3.  **Observability**: Use emojis and clear `echo` statements for every major step.
4.  **Modern Patterns**: Use `[[ ]]` for shell tests and ensure all variables are quoted to handle spaces.
5.  **Harvest-Ready**: Maintain the `<!-- jcapy:EXEC -->` anchor and the Markdown structure.

### Output Format:
Return **only** the improved Markdown content. Do not include conversational filler.


--- TARGET CONTEXT ---
# JCapy Project Memory

## ğŸ›°ï¸ TUI Architecture Specifications

### 1. Unified Interface Framework
- **Engine**: Textual (`textual` library).
- **Global Shell**: `JCapyApp` (handles Command Palette, Terminal Log, and Theme Sync).

### 2. Main Dashboard (Cockpit)
- **Grid Layout**: 3-Column main area + Left Sidebar.
- **Sidebar**: Fixed width (26 chars), contains:
  - `JCAPY_LOGO_COMPACT`
  - `StatusWidget` (System health)
  - `ClockWidget`, `ProjectStatusWidget`
  - Control Buttons: `âš™ï¸ Manage`, `ğŸ” Find`, `ğŸšª Quit`
- **Center Area**: Main focus widgets (Kanban, Editors).
- **Secondary Areas**: Left (Infrastructure) and Right (Marketplace/Usage).
- **Commands**:
  - `z`: Zen Mode (Hides everything but center).
  - `e`: Edit Layout (Toggle drag-and-drop widget swapping).
  - `c`: Toggle Right Column (Collapse/Expand).

### 3. Management Screen (Repair Bay)
- **ğŸš€ Projects Ongoing**:
  - **Identity**: Rebranded from "Persona Fleet". Supports unlimited projects/repos.
  - **Status**: Live Git branch `[main]` and pending count `(dirty)` tracking.
  - **Keys**: `s` (Sync), `p` (Push), `c` (Commit), `u` (Remote).
- **ğŸ”Œ MCP Servers**: Dynamic list of active protocols.
- **ğŸ§© Workspace Elements**: Registry for all installed Widgets and Skills (Plugins).
- **ğŸ¨ Themes**: One-click switching via `ThemeItem` gallery.
### 4. v2.0 Architectural Directives
- **ğŸ•¹ï¸ Modal Input Engine**: Formalized the requirement for a state machine to handle **NORMAL**, **INSERT**, and **VISUAL** modes in the core client.
- **ğŸ§© Command Grammar**: Added the "Verb + Noun" composability as a core performance metric.
- **âš¡ Async Core Benchmarks**: Updated the technology stack to prioritize non-blocking job control (via Textual `@work`) and byte-stream output for GPU-accelerated terminals.

### ğŸš« Design Constraints (DO NOT MODIFY):
1. **Logo Stability**: Never remove or reposition the JCapy logo from the Dashboard sidebar.
2. **Action Grouping**: Git actions must remain horizontally grouped in the Management screen.
3. **Glass Aesthetics**: Maintain transparent surface backgrounds ($surface @ 30-45%) across all screens.
4. **Hotkey Integrity**: `s/p/c/u` bindings for Projects are reserved and must not be reassigned.
5. **Terminology**: "Persona" is for config usage ONLY. The UI MUST strictly use "Project".
